<!DOCTYPE html>
<html>
<body style="margin:0;">
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

// ================== 画布尺寸（固定） ==================
const BASE_WIDTH = 1260;
const BASE_HEIGHT = 2736;
canvas.width = BASE_WIDTH;
canvas.height = BASE_HEIGHT;

// ================== 日历缩放因子（唯一需要调的） ==================
const CALENDAR_SCALE = 1.25;

// ================== 背景（暗色模式） ==================
ctx.fillStyle = "#0b0b0d";
ctx.fillRect(0, 0, canvas.width, canvas.height);

// ================== 预留区域（不缩放） ==================
const TOP_RESERVED = 420;
const BOTTOM_RESERVED = 420;

const CALENDAR_TOP = TOP_RESERVED;
const CALENDAR_BOTTOM = canvas.height - BOTTOM_RESERVED;
const CALENDAR_HEIGHT = CALENDAR_BOTTOM - CALENDAR_TOP;

// ================== 日期 ==================
const today = new Date();
const year = today.getFullYear();
const startOfYear = new Date(year, 0, 1);
const dayOfYear =
  Math.floor((today - startOfYear) / 86400000) + 1;

// ================== 月份数据 ==================
const months = [
  { name: "Jan", days: 31 },
  { name: "Feb", days: new Date(year, 1, 29).getMonth() === 1 ? 29 : 28 },
  { name: "Mar", days: 31 },
  { name: "Apr", days: 30 },
  { name: "May", days: 31 },
  { name: "Jun", days: 30 },
  { name: "Jul", days: 31 },
  { name: "Aug", days: 31 },
  { name: "Sep", days: 30 },
  { name: "Oct", days: 31 },
  { name: "Nov", days: 30 },
  { name: "Dec", days: 31 },
];

// ================== 日历基础尺寸（不带 scale） ==================
const MONTHS_PER_ROW = 3;
const cols = 7;

const size = 22;
const gap = 10;

const monthTitleHeight = 36;
const titleGap = 14;
const monthBlockGap = 36;
const rowGap = 60;

// ================== 单个月高度 ==================
function monthHeight(days, monthIndex) {
  const firstDay = new Date(year, monthIndex, 1).getDay();
  const offset = (firstDay + 6) % 7;
  const totalCells = offset + days;
  const rows = Math.ceil(totalCells / cols);

  return (
    monthTitleHeight +
    titleGap +
    rows * size +
    (rows - 1) * gap
  );
}

const maxMonthHeight = Math.max(
  ...months.map((m, i) => monthHeight(m.days, i))
);

// ================== 整体日历高度 ==================
const rows = 4;
const calendarHeight =
  rows * maxMonthHeight +
  (rows - 1) * rowGap;

// ================== 计算缩放后的居中位置 ==================
const scaledCalendarHeight = calendarHeight * CALENDAR_SCALE;
const calendarStartY =
  CALENDAR_TOP +
  (CALENDAR_HEIGHT - scaledCalendarHeight) / 2;

// ================== 开始绘制「缩放日历」 ==================
ctx.save();

// 把坐标原点移到日历左上角（缩放前坐标系）
ctx.translate(
  canvas.width / 2,
  calendarStartY
);

// 只缩放日历
ctx.scale(CALENDAR_SCALE, CALENDAR_SCALE);

// 因为 scale 了，x 要反向偏移一半
ctx.translate(-canvas.width / 2, 0);

let cursorY = 0;
let dayCounter = 1;

// ================== 绘制月份 ==================
for (let r = 0; r < rows; r++) {
  const rowMonths = months.slice(
    r * MONTHS_PER_ROW,
    r * MONTHS_PER_ROW + MONTHS_PER_ROW
  );

  const monthWidth = cols * size + (cols - 1) * gap;
  const rowWidth =
    MONTHS_PER_ROW * monthWidth +
    (MONTHS_PER_ROW - 1) * monthBlockGap;

  let cursorX = (canvas.width - rowWidth) / 2;

  rowMonths.forEach((month, mIndex) => {
    const monthIndex = r * MONTHS_PER_ROW + mIndex;

    // ---- 月份标题 ----
    ctx.fillStyle = "#8e8e93";
    ctx.font = `32px -apple-system, BlinkMacSystemFont`;
    ctx.textAlign = "center";
    ctx.fillText(
      month.name,
      cursorX + monthWidth / 2,
      cursorY + monthTitleHeight - 6
    );

    const firstDay = new Date(year, monthIndex, 1).getDay();
    const offset = (firstDay + 6) % 7;

    const yStart = cursorY + monthTitleHeight + titleGap;

    for (let i = 0; i < month.days; i++) {
      const index = offset + i;
      const x = cursorX + (index % cols) * (size + gap);
      const y = yStart + Math.floor(index / cols) * (size + gap);

      if (dayCounter < dayOfYear) {
        ctx.fillStyle = "#f2f2f7";
      } else if (dayCounter === dayOfYear) {
        ctx.fillStyle = "#ff453a";
      } else {
        ctx.fillStyle = "#2c2c2e";
      }

      ctx.fillRect(x, y, size, size);

      if (dayCounter === dayOfYear) {
        ctx.strokeStyle = "rgba(255,69,58,0.6)";
        ctx.lineWidth = 2;
        ctx.strokeRect(x - 2, y - 2, size + 4, size + 4);
      }

      dayCounter++;
    }

    cursorX += monthWidth + monthBlockGap;
  });

  cursorY += maxMonthHeight + rowGap;
}

ctx.restore();
</script>
</body>
</html>
